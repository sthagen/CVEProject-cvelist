{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2023-25610",
        "ASSIGNER": "psirt@fortinet.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A buffer underwrite ('buffer underflow') vulnerability in the administrative interface of Fortinet FortiOS version 7.2.0 through 7.2.3, version 7.0.0 through 7.0.6, version 6.4.0 through 6.4.11 and version 6.2.12 and below, FortiProxy version 7.2.0 through 7.2.2, version 7.0.0 through 7.0.8, version 2.0.12 and below and FortiOS-6K7K version 7.0.5, version 6.4.0 through 6.4.10 and version 6.2.0 through 6.2.10 and below allows a remote unauthenticated attacker to execute arbitrary code or commands via specifically crafted requests."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Execute unauthorized code or commands",
                        "cweId": "CWE-124"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Fortinet",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "FortiSwitchManager",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.2.0",
                                            "version_value": "7.2.1"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.0.0",
                                            "version_value": "7.0.1"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "FortiAnalyzer",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "7.2.0"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.0.0",
                                            "version_value": "7.0.4"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.4.0",
                                            "version_value": "6.4.11"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.2.0",
                                            "version_value": "6.2.10"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.0.0",
                                            "version_value": "6.0.11"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "FortiOS-6K7K",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "7.0.5"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.4.10"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.4.8"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.4.6"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.4.2"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.2.9",
                                            "version_value": "6.2.12"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.2.6",
                                            "version_value": "6.2.7"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.2.4"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.0.12",
                                            "version_value": "6.0.18"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.0.10"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "FortiProxy",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.2.0",
                                            "version_value": "7.2.2"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.0.0",
                                            "version_value": "7.0.8"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "2.0.0",
                                            "version_value": "2.0.14"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "1.2.0",
                                            "version_value": "1.2.13"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "1.1.0",
                                            "version_value": "1.1.6"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "FortiOS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.2.0",
                                            "version_value": "7.2.3"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.0.0",
                                            "version_value": "7.0.9"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.4.0",
                                            "version_value": "6.4.11"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.2.0",
                                            "version_value": "6.2.12"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.0.0",
                                            "version_value": "6.0.18"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "5.6.0",
                                            "version_value": "5.6.14"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "5.4.0",
                                            "version_value": "5.4.13"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "5.2.0",
                                            "version_value": "5.2.15"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "5.0.0",
                                            "version_value": "5.0.14"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "FortiManager",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "7.2.0"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.0.0",
                                            "version_value": "7.0.4"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.4.0",
                                            "version_value": "6.4.11"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.2.0",
                                            "version_value": "6.2.10"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.0.0",
                                            "version_value": "6.0.11"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "FortiWeb",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.2.0",
                                            "version_value": "7.2.1"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.0.0",
                                            "version_value": "7.0.6"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.4.0",
                                            "version_value": "6.4.2"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.3.0",
                                            "version_value": "6.3.22"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.2.0",
                                            "version_value": "6.2.7"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "6.1.0",
                                            "version_value": "6.1.3"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://fortiguard.com/psirt/FG-IR-23-001",
                "refsource": "MISC",
                "name": "https://fortiguard.com/psirt/FG-IR-23-001"
            }
        ]
    },
    "solution": [
        {
            "lang": "en",
            "value": "Please upgrade to FortiOS version 7.4.0 or above\r\nPlease upgrade to FortiOS version 7.2.4 or above\r\nPlease upgrade to FortiOS version 7.0.10 or above\r\nPlease upgrade to FortiOS version 6.4.12 or above\r\nPlease upgrade to FortiOS version 6.2.13 or above\r\nPlease upgrade to FortiWeb version 7.2.2 or above\r\nPlease upgrade to FortiWeb version 7.0.7 or above\r\nPlease upgrade to FortiWeb version 6.4.3 or above\r\nPlease upgrade to FortiWeb version 6.3.23 or above\r\nPlease upgrade to FortiWeb version 6.2.8 or above\r\nPlease upgrade to FortiWeb version 6.1.4 or above\r\nPlease upgrade to upcoming FortiOS version 6.0.17 or above\r\nPlease upgrade to FortiSwitchManager version 7.2.2 or above\r\nPlease upgrade to FortiSwitchManager version 7.0.2 or above\r\nPlease upgrade to FortiProxy version 7.2.3 or above\r\nPlease upgrade to FortiProxy version 7.0.9 or above\r\nPlease upgrade to FortiManager version 7.2.1 or above\r\nPlease upgrade to FortiManager version 7.0.5 or above\r\nPlease upgrade to FortiManager version 6.4.12 or above\r\nPlease upgrade to FortiManager version 6.2.11 or above\r\nPlease upgrade to FortiManager version 6.0.12 or above\r\nPlease upgrade to FortiOS-6K7K version 7.0.10 or above\r\nPlease upgrade to FortiOS-6K7K version 6.4.12 or above\r\nPlease upgrade to FortiOS-6K7K version 6.2.13 or above\r\nPlease upgrade to FortiAnalyzer version 7.2.1 or above\r\nPlease upgrade to FortiAnalyzer version 7.0.5 or above\r\nPlease upgrade to FortiAnalyzer version 6.4.12 or above\r\nPlease upgrade to FortiAnalyzer version 6.2.11 or above\r\nPlease upgrade to FortiAnalyzer version 6.0.12 or above\r\n\r\n\r\n## Workaround for FortiOS:\r\n\r\n\r\n\r\nDisable HTTP/HTTPS administrative interface\r\n\r\nOR\r\n\r\nLimit IP addresses that can reach the administrative interface:\r\n\r\n\r\n```\r\nconfig firewall address\r\nedit my_allowed_addresses\r\nset subnet Y IP MY SUBNET\r\nend\r\n```\r\n\r\nThen create an Address Group:\r\n\r\n\r\n```\r\nconfig firewall addrgrp\r\nedit MGMT_IPs\r\nset member my_allowed_addresses\r\nend\r\n```\r\n\r\nCreate the Local in Policy to restrict access only to the predefined group on management interface (here: port1):\r\n\r\n\r\n```\r\nconfig firewall local-in-policy\r\nedit 1\r\nset intf port1\r\nset srcaddr MGMT_IPs\r\nset dstaddr all\r\nset action accept\r\nset service HTTPS HTTP\r\nset schedule always\r\nset status enable\r\nnext\r\n\r\n\r\n\r\nedit 2\r\nset intf any\r\nset srcaddr all\r\nset dstaddr all\r\nset action deny\r\nset service HTTPS HTTP\r\nset schedule always\r\nset status enable\r\nend\r\n```\r\n\r\n\r\nIf using non default ports, create appropriate service object for GUI administrative access:\r\n\r\n```\r\nconfig firewall service custom\r\nedit GUI_HTTPS\r\nset tcp-portrange admin-sport\r\nnext\r\nedit GUI_HTTP\r\nset tcp-portrange admin-port\r\nend\r\n```\r\n\r\n\r\nUse these objects instead of \"HTTPS HTTP\" in the local-in policy 1 and 2 below.\r\n\r\n\r\nWhen using an HA reserved management interface, the local in policy needs to be configured slightly differently - please see: \r\n\r\nhttps://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-configure-a-local-in-policy-on-a-HA/ta-p/222005\r\n\r\nPlease contact customer support for assistance.\r\n\r\n\r\n## Workaround for FortiManager and FortiAnalyzer:\r\n\r\n\r\nLimit IP addresses that can reach the administrative interface\r\n\r\n\r\n## Workaround for FortiWeb:\r\n\r\n\r\n\r\nDisable HTTP/HTTPS administrative interface\r\n\r\nOR\r\n\r\nLimit IP addresses that can reach the administrative interface"
        }
    ],
    "impact": {
        "cvss": [
            {
                "version": "3.1",
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 9.3,
                "baseSeverity": "CRITICAL",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:U/RC:C"
            }
        ]
    }
}