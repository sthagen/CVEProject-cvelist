{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2025-21594",
        "ASSIGNER": "sirt@juniper.net",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Improper Check for Unusual or Exceptional Conditions vulnerability in the pfe (packet forwarding engine) of Juniper Networks Junos OS on MX Series causes a port within a pool to be blocked leading to Denial of Service (DoS).\n\nIn a DS-Lite (Dual-Stack Lite) and NAT (Network Address Translation) scenario, when crafted IPv6 traffic is received and\u00a0prefix-length is set to 56,\u00a0the ports assigned to the user will not be freed.\u00a0 Eventually, users cannot establish new connections. Affected FPC/PIC need to be manually restarted to recover.\nFollowing is the command to identify the issue:\u00a0\n\n\n\u00a0 \u00a0 user@host> show services nat source port-block\u00a0\n\u2003\u2003\u2003\u2003Host_IP  \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0  External_IP  \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Port_Block\u00a0 \u00a0 \u00a0 Ports_Used/  \u00a0 \u00a0 \u00a0 Block_State/\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0  Range  \u00a0 \u00a0 \u00a0 \u00a0 \u00a0  Ports_Total  \u00a0 \u00a0 \u00a0 Left_Time(s)\n\u2003\u2003\u2003\u20032001::\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 x.x.x.x\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a058880-59391\u00a0 \u00a0 \u00a0256/256*1\u00a0 \u00a0 \u00a0 \u00a0 \u00a0Active/-  \u00a0 \u00a0 \u00a0 >>>>>>>>port still usedThis issue affects Junos OS on MX Series:\u00a0\n\n  *  from 21.2 before 21.2R3-S8,\u00a0\n  *  from 21.4 before 21.4R3-S7,\u00a0\n  *  from 22.1 before 22.1R3-S6,\u00a0\n  *  from 22.2 before 22.2R3-S4,\u00a0\n  *  from 22.3 before 22.3R3-S3,\u00a0\n  *  from 22.4 before 22.4R3-S2,\u00a0\n  *  from 23.2 before 23.2R2-S1,\u00a0\n  *  from 23.4 before 23.4R1-S2, 23.4R2.\n\n\nThis issue does not affect versions before 20.2R1."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-754: Improper Check for Unusual or Exceptional Conditions",
                        "cweId": "CWE-754"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Juniper Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "lessThan": "21.2R3-S8",
                                                        "status": "affected",
                                                        "version": "0",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "21.4R3-S7",
                                                        "status": "affected",
                                                        "version": "21.4",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.1R3-S6",
                                                        "status": "affected",
                                                        "version": "22.1",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.2R3-S4",
                                                        "status": "affected",
                                                        "version": "22.2",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.3R3-S3",
                                                        "status": "affected",
                                                        "version": "22.3",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.4R3-S2",
                                                        "status": "affected",
                                                        "version": "22.4",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "23.2R2-S1",
                                                        "status": "affected",
                                                        "version": "23.2",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "23.4R1-S2, 23.4R2",
                                                        "status": "affected",
                                                        "version": "23.4",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "20.2R1",
                                                        "status": "unaffected",
                                                        "version": "0",
                                                        "versionType": "semver"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://supportportal.juniper.net/JSA96449",
                "refsource": "MISC",
                "name": "https://supportportal.juniper.net/JSA96449"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "advisory": "JSA96449",
        "defect": [
            "1785403"
        ],
        "discovery": "USER"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "This issue only occurs when below config is enabled:<br><br><tt>[ set services service-set &lt;*&gt; softwire-options dslite-ipv6-prefix-length 56]<br></tt><br><br>"
                }
            ],
            "value": "This issue only occurs when below config is enabled:\n\n[ set services service-set <*> softwire-options dslite-ipv6-prefix-length 56]"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Modify the IPv6 prefix-length to be 64/96/128 through the command:<br><tt><br>[ set services service-set &lt;*&gt; softwire-options dslite-ipv6-prefix-length 64/96/128]</tt>"
                }
            ],
            "value": "Modify the IPv6 prefix-length to be 64/96/128 through the command:\n\n[ set services service-set <*> softwire-options dslite-ipv6-prefix-length 64/96/128]"
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "The following software releases have been updated to resolve this specific issue: <br><br>Junos OS: 21.2R3-S8, 21.4R3-S7, 22.1R3-S6, 22.2R3-S4, 22.3R3-S3, 22.4R3-S2, 23.2R2-S1, 23.4R1-S2, 23.4R2, 24.2R1, and all subsequent releases."
                }
            ],
            "value": "The following software releases have been updated to resolve this specific issue: \n\nJunos OS: 21.2R3-S8, 21.4R3-S7, 22.1R3-S6, 22.2R3-S4, 22.3R3-S3, 22.4R3-S2, 23.2R2-S1, 23.4R1-S2, 23.4R2, 24.2R1, and all subsequent releases."
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 7.5,
                "baseSeverity": "HIGH",
                "confidentialityImpact": "NONE",
                "integrityImpact": "NONE",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                "version": "3.1"
            }
        ]
    }
}