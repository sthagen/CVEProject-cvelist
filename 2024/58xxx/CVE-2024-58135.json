{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-58135",
        "ASSIGNER": "cve-request@security.metacpan.org",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "Mojolicious versions from 7.28 through 9.39 for Perl may generate weak HMAC session secrets.\n\nWhen creating a default app with the \"mojo generate app\" tool, a weak secret is written to the application's configuration file using the insecure rand() function, and used for authenticating and protecting the integrity of the application's sessions. This may allow an attacker to brute force the application's session keys."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-338 Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)",
                        "cweId": "CWE-338"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "SRI",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Mojolicious",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "7.28",
                                            "version_value": "9.39"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://perldoc.perl.org/functions/rand",
                "refsource": "MISC",
                "name": "https://perldoc.perl.org/functions/rand"
            },
            {
                "url": "https://metacpan.org/release/SRI/Mojolicious-9.39/source/lib/Mojo/Util.pm#L181",
                "refsource": "MISC",
                "name": "https://metacpan.org/release/SRI/Mojolicious-9.39/source/lib/Mojo/Util.pm#L181"
            },
            {
                "url": "https://metacpan.org/release/SRI/Mojolicious-9.38/source/lib/Mojolicious/Command/Author/generate/app.pm#L202",
                "refsource": "MISC",
                "name": "https://metacpan.org/release/SRI/Mojolicious-9.38/source/lib/Mojolicious/Command/Author/generate/app.pm#L202"
            },
            {
                "url": "https://github.com/mojolicious/mojo/pull/2200",
                "refsource": "MISC",
                "name": "https://github.com/mojolicious/mojo/pull/2200"
            },
            {
                "url": "https://metacpan.org/release/SRI/Mojolicious-7.28/source/lib/Mojolicious/Command/generate/app.pm#L220",
                "refsource": "MISC",
                "name": "https://metacpan.org/release/SRI/Mojolicious-7.28/source/lib/Mojolicious/Command/generate/app.pm#L220"
            },
            {
                "url": "https://security.metacpan.org/docs/guides/random-data-for-security.html",
                "refsource": "MISC",
                "name": "https://security.metacpan.org/docs/guides/random-data-for-security.html"
            },
            {
                "url": "https://github.com/hashcat/hashcat/pull/4090",
                "refsource": "MISC",
                "name": "https://github.com/hashcat/hashcat/pull/4090"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.2.0"
    },
    "source": {
        "discovery": "UNKNOWN"
    },
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Ensure that your secret, stored in the application's configuration file, is at least 128 bit of cryptographically secure random data. For example, to generate a 256 bit secret, one could use the output generated by the \"openssl rand -base64 32\" command."
                }
            ],
            "value": "Ensure that your secret, stored in the application's configuration file, is at least 128 bit of cryptographically secure random data. For example, to generate a 256 bit secret, one could use the output generated by the \"openssl rand -base64 32\" command."
        },
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "As of version 9.39 of Mojolicious, if a CryptX distribution of version 0.080 or later is available in the include path before calling the \"mojo generate app\" tool, then a secure 1024 bit long secret will be generated."
                }
            ],
            "value": "As of version 9.39 of Mojolicious, if a CryptX distribution of version 0.080 or later is available in the include path before calling the \"mojo generate app\" tool, then a secure 1024 bit long secret will be generated."
        }
    ]
}