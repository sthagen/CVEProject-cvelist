{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-3400",
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A command injection vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurations may enable an unauthenticated attacker to execute arbitrary code with root privileges on the firewall.\n\nCloud NGFW, Panorama appliances, and Prisma Access are not impacted by this vulnerability."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-77 Improper Neutralization of Special Elements used in a Command ('Command Injection')",
                        "cweId": "CWE-77"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Palo Alto Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "PAN-OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "unaffected",
                                                        "version": "9.0.0"
                                                    },
                                                    {
                                                        "status": "unaffected",
                                                        "version": "9.1.0"
                                                    },
                                                    {
                                                        "status": "unaffected",
                                                        "version": "10.0.0"
                                                    },
                                                    {
                                                        "status": "unaffected",
                                                        "version": "10.1.0"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "10.2.9-h1",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "10.2.9-h1",
                                                        "status": "affected",
                                                        "version": "10.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "11.0.4-h1",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "11.0.4-h1",
                                                        "status": "affected",
                                                        "version": "11.0.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "11.1.2-h3",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "11.1.2-h3",
                                                        "status": "affected",
                                                        "version": "11.1.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Cloud NGFW",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "unaffected",
                                                        "version": "All"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Prisma Access",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "unaffected",
                                                        "version": "All"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://security.paloaltonetworks.com/CVE-2024-3400",
                "refsource": "MISC",
                "name": "https://security.paloaltonetworks.com/CVE-2024-3400"
            },
            {
                "url": "https://unit42.paloaltonetworks.com/cve-2024-3400/",
                "refsource": "MISC",
                "name": "https://unit42.paloaltonetworks.com/cve-2024-3400/"
            },
            {
                "url": "https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/",
                "refsource": "MISC",
                "name": "https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "defect": [
            "PAN-252214"
        ],
        "discovery": "USER"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both) and device telemetry enabled.<br><br>You can verify whether you have a GlobalProtect gateway or GlobalProtect portal configured by checking for entries in your firewall web interface (Network &gt; GlobalProtect &gt; Gateways or Network &gt; GlobalProtect &gt; Portals) and verify whether you have device telemetry enabled by checking your firewall web interface (Device &gt; Setup &gt; Telemetry)."
                }
            ],
            "value": "This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both) and device telemetry enabled.\n\nYou can verify whether you have a GlobalProtect gateway or GlobalProtect portal configured by checking for entries in your firewall web interface (Network > GlobalProtect > Gateways or Network > GlobalProtect > Portals) and verify whether you have device telemetry enabled by checking your firewall web interface (Device > Setup > Telemetry)."
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Recommended Mitigation: Customers with a Threat Prevention subscription can block attacks for this vulnerability using Threat ID 95187 (available in Applications and Threats content version 8833-8682 and later).<br><br>To apply Threat ID 95187, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. Please see <a target=\"_blank\" rel=\"nofollow\" href=\"https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184\">https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184</a>&nbsp;for more information.<br><br>If you are unable to apply the Threat Prevention based mitigation at this time, you can still mitigate the impact of this vulnerability by temporarily disabling device telemetry until the device is upgraded to a fixed PAN-OS version. Once upgraded, device telemetry should be re-enabled on the device. If the firewalls are managed by Panorama, ensure that device telemetry is disabled in relevant templates (Panorama &gt; Templates).<br><br>Please see the following page for details on how to temporarily disable device telemetry: <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-admin/device-telemetry/device-telemetry-configure/device-telemetry-disable\">https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-admin/device-telemetry/device-telemetry-configure/device-telemetry-disable</a>.<br><br>Please see the following page for details on how to configure Panorama templates: <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/panorama/11-0/panorama-admin/manage-firewalls/manage-templates-and-template-stacks/add-a-template\">https://docs.paloaltonetworks.com/panorama/11-0/panorama-admin/manage-firewalls/manage-templates-and-template-stacks/add-a-template</a>."
                }
            ],
            "value": "Recommended Mitigation: Customers with a Threat Prevention subscription can block attacks for this vulnerability using Threat ID 95187 (available in Applications and Threats content version 8833-8682 and later).\n\nTo apply Threat ID 95187, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. Please see  https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184 \u00a0for more information.\n\nIf you are unable to apply the Threat Prevention based mitigation at this time, you can still mitigate the impact of this vulnerability by temporarily disabling device telemetry until the device is upgraded to a fixed PAN-OS version. Once upgraded, device telemetry should be re-enabled on the device. If the firewalls are managed by Panorama, ensure that device telemetry is disabled in relevant templates (Panorama > Templates).\n\nPlease see the following page for details on how to temporarily disable device telemetry:  https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-admin/device-telemetry/device-telemetry-configure/device-telemetry-disable .\n\nPlease see the following page for details on how to configure Panorama templates:  https://docs.paloaltonetworks.com/panorama/11-0/panorama-admin/manage-firewalls/manage-templates-and-template-stacks/add-a-template ."
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Palo Alto Networks is aware of a limited number of attacks that leverage the exploitation of this vulnerability.<br><br>More information about the vulnerability's exploitation in the wild can be found in the Unit 42 threat brief: <a target=\"_blank\" rel=\"nofollow\" href=\"https://unit42.paloaltonetworks.com/cve-2024-3400/\">https://unit42.paloaltonetworks.com/cve-2024-3400/</a>."
                }
            ],
            "value": "Palo Alto Networks is aware of a limited number of attacks that leverage the exploitation of this vulnerability.\n\nMore information about the vulnerability's exploitation in the wild can be found in the Unit 42 threat brief:  https://unit42.paloaltonetworks.com/cve-2024-3400/ ."
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<span style=\"background-color: rgb(255, 255, 255);\">This issue is fixed in hotfix releases of PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions. Hotfixes for other commonly deployed maintenance releases will also be made available to address this issue.</span><br>"
                }
            ],
            "value": "This issue is fixed in hotfix releases of PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions. Hotfixes for other commonly deployed maintenance releases will also be made available to address this issue.\n"
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Palo Alto Networks thanks Volexity for detecting and identifying this issue."
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 10,
                "baseSeverity": "CRITICAL",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "NONE",
                "scope": "CHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
                "version": "3.1"
            }
        ]
    }
}