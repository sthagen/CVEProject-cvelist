{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-12378",
        "ASSIGNER": "psirt@arista.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On affected platforms running Arista EOS with secure Vxlan configured, restarting the Tunnelsec agent will result in packets being sent over the secure Vxlan tunnels in the clear."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-319 Cleartext Transmission of Sensitive Information",
                        "cweId": "CWE-319"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Arista Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "CloudVision Portal",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.32.0",
                                            "version_value": "4.32.2F"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.31.0",
                                            "version_value": "4.31.6M"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.30.0",
                                            "version_value": "4.30.8M"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.29.0",
                                            "version_value": "4.29.9M"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.28.0",
                                            "version_value": "4.28.12M"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.27.0",
                                            "version_value": "4.27.12M"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/21289-security-advisory-0113",
                "refsource": "MISC",
                "name": "https://www.arista.com/en/support/advisories-notices/security-advisory/21289-security-advisory-0113"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.2.0"
    },
    "source": {
        "advisory": "113",
        "defect": [
            "BUG 997526"
        ],
        "discovery": "INTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>In order to be vulnerable to CVE-2024-12378, the following condition must be met:</p><p>Secure Vxlan must be configured.</p><p>The output of \u201cshow ip security connection\u201d is empty if Secure Vxlan isn\u2019t configured.</p><pre>switch&gt; show ip security connection\nLegend: (P) policy based VPN tunnel\nTunnel &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;         Source &nbsp; &nbsp;  Dest &nbsp; &nbsp; &nbsp; &nbsp;Status &nbsp;  &nbsp; &nbsp; Uptime &nbsp; &nbsp;  Input  &nbsp; &nbsp;Output &nbsp; &nbsp; Rekey       Time\nvxlansec-default-1.0.2.1 1.0.1.1  &nbsp;  1.0.2.1  &nbsp;  <b>Established</b>&nbsp;    19 minutes  0 bytes  &nbsp;152 bytes             &nbsp;24 minutes\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &nbsp; 0 pkts &nbsp; &nbsp;2 pkts\n</pre><div>&nbsp;</div><p>A normal encrypted connection will show the status as \u201cestablished\u201d.</p><br>"
                }
            ],
            "value": "In order to be vulnerable to CVE-2024-12378, the following condition must be met:\n\nSecure Vxlan must be configured.\n\nThe output of \u201cshow ip security connection\u201d is empty if Secure Vxlan isn\u2019t configured.\n\nswitch> show ip security connection\nLegend: (P) policy based VPN tunnel\nTunnel \u00a0 \u00a0 \u00a0 \u00a0 \u00a0         Source \u00a0 \u00a0  Dest \u00a0 \u00a0 \u00a0 \u00a0Status \u00a0  \u00a0 \u00a0 Uptime \u00a0 \u00a0  Input  \u00a0 \u00a0Output \u00a0 \u00a0 Rekey       Time\nvxlansec-default-1.0.2.1 1.0.1.1  \u00a0  1.0.2.1  \u00a0  Established\u00a0    19 minutes  0 bytes  \u00a0152 bytes             \u00a024 minutes\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0  \u00a0 0 pkts \u00a0 \u00a02 pkts\n\n\n\u00a0\n\nA normal encrypted connection will show the status as \u201cestablished\u201d."
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The workaround is to remove and re-apply security profiles for each secure VTEP.</p><pre>switch&gt; show vxlan security profile\nVTEP  &nbsp; &nbsp; &nbsp; &nbsp; Security Profile\n------------- ----------------\n1.0.2.1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p1\nswitch&gt; en\nswitch# config\nswitch(config)# interface vxlan 1\nswitch(config-if-Vx1)# no vxlan vtep 1.0.2.1 ip security profile p1\nswitch(config-if-Vx1)# vxlan vtep 1.0.2.1 ip security profile p1</pre><br>"
                }
            ],
            "value": "The workaround is to remove and re-apply security profiles for each secure VTEP.\n\nswitch> show vxlan security profile\nVTEP  \u00a0 \u00a0 \u00a0 \u00a0 Security Profile\n------------- ----------------\n1.0.2.1 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 p1\nswitch> en\nswitch# config\nswitch(config)# interface vxlan 1\nswitch(config-if-Vx1)# no vxlan vtep 1.0.2.1 ip security profile p1\nswitch(config-if-Vx1)# vxlan vtep 1.0.2.1 ip security profile p1"
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades\">EOS User Manual: Upgrades and Downgrades</a></p><div>&nbsp;</div><div>CVE-2024-12378 has been fixed in the following releases:</div><ul><li>4.33.0F and later releases in the 4.33.x train</li><li>4.32.3M and later releases in the 4.32.x train</li><li>4.31.7M and later releases in the 4.31.x train</li><li>4.30.9M and later releases in the 4.30.x train</li><li>4.29.10M and later releases in the 4.29.x train</li></ul><br>"
                }
            ],
            "value": "The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see  EOS User Manual: Upgrades and Downgrades https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades \n\n\u00a0\n\nCVE-2024-12378 has been fixed in the following releases:\n\n  *  4.33.0F and later releases in the 4.33.x train\n  *  4.32.3M and later releases in the 4.32.x train\n  *  4.31.7M and later releases in the 4.31.x train\n  *  4.30.9M and later releases in the 4.30.x train\n  *  4.29.10M and later releases in the 4.29.x train"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "NONE",
                "baseScore": 9.1,
                "baseSeverity": "CRITICAL",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
                "version": "3.1"
            }
        ]
    }
}