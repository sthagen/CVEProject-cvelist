{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-11186",
        "ASSIGNER": "psirt@arista.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On affected versions of the CloudVision Portal, improper access controls could enable a malicious authenticated user to take broader actions on managed EOS devices than intended. This advisory impacts the Arista CloudVision Portal products when run on-premise. It does not impact CloudVision as-a-Service."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-287 Improper Authentication",
                        "cweId": "CWE-287"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Arista Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "CloudVision Portal",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "2024.3.0"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "2024.2.0",
                                            "version_value": "2024.2.1"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "2024.1.0",
                                            "version_value": "2024.1.2"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2023.3"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2023.2"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2023.1"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2022.3"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2022.2"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2022.1"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2021.3"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2021.2"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2021.1"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2020.3"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2020.2"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2020.1"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2019.1"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2018.2"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2018.1"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "2017.2"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/21314-security-advisory-0114",
                "refsource": "MISC",
                "name": "https://www.arista.com/en/support/advisories-notices/security-advisory/21314-security-advisory-0114"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.2.0"
    },
    "source": {
        "advisory": "114",
        "defect": [
            "BUG 1029707"
        ],
        "discovery": "INTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<div>In order to be vulnerable to CVE-2024-11186, the following condition must be met:</div><ul><li>A user must be able to authenticate with CloudVision</li></ul><br>"
                }
            ],
            "value": "In order to be vulnerable to CVE-2024-11186, the following condition must be met:\n\n  *  A user must be able to authenticate with CloudVision"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The workaround is to append the following to /etc/nginx/conf.d/locations/cvp.https.conf on all CVP nodes:</p><pre>location ^~ /cvpservice/di/ {\n    return 404;\n}\n</pre><div>&nbsp;</div><p>Then restart nginx by running the following command on any node:</p><pre>nginx-app.sh reload</pre><br>"
                }
            ],
            "value": "The workaround is to append the following to /etc/nginx/conf.d/locations/cvp.https.conf on all CVP nodes:\n\nlocation ^~ /cvpservice/di/ {\n    return 404;\n}\n\n\n\u00a0\n\nThen restart nginx by running the following command on any node:\n\nnginx-app.sh reload"
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.io/help/2024.3/articles/dXBncmFkZS5BbGwudXBncmFkZQ==\">CloudVision Users Guide</a>.</p><div>&nbsp;</div><div>CVE-2024-11186 has been fixed in the following releases:</div><ul><li>2025.1.0 and later releases in the 2025.1.x train</li><li>2024.3.1 and later releases in the 2024.3.x train</li><li>2024.2.2 and later releases in the 2024.2.x train</li><li>2024.1.3 and later releases in the 2024.1.x train</li></ul><br>"
                }
            ],
            "value": "The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see  CloudVision Users Guide https://www.arista.io/help/2024.3/articles/dXBncmFkZS5BbGwudXBncmFkZQ== .\n\n\u00a0\n\nCVE-2024-11186 has been fixed in the following releases:\n\n  *  2025.1.0 and later releases in the 2025.1.x train\n  *  2024.3.1 and later releases in the 2024.3.x train\n  *  2024.2.2 and later releases in the 2024.2.x train\n  *  2024.1.3 and later releases in the 2024.1.x train"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 10,
                "baseSeverity": "CRITICAL",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "NONE",
                "scope": "CHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
                "version": "3.1"
            }
        ]
    }
}